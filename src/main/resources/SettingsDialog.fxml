<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Slider?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.Tooltip?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Pane?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import java.net.URL?>

<StackPane xmlns="http://javafx.com/javafx"
           xmlns:fx="http://javafx.com/fxml"
           fx:controller="com.comp2042.app.SettingsController"
           styleClass="settings-dialog-root">
    <children>
        <Pane styleClass="grid-overlay"/>
        <Pane styleClass="scanline-overlay"/>
        <BorderPane styleClass="settings-dialog" prefWidth="760">
            <top>
                <VBox spacing="6" styleClass="settings-header">
                    <Label text="Systems Console" styleClass="settings-kicker"/>
                    <Label text="Tune repeat timings, bindings, and presentation without leaving your run."
                           wrapText="true"
                           styleClass="settings-title"/>
                </VBox>
            </top>
            <center>
                <ScrollPane fitToWidth="true"
                            hbarPolicy="NEVER"
                            styleClass="settings-scroll-pane">
                    <content>
                        <GridPane hgap="24" vgap="18" styleClass="settings-content">
                            <columnConstraints>
                                <ColumnConstraints percentWidth="50"/>
                                <ColumnConstraints percentWidth="50"/>
                            </columnConstraints>

                            <VBox spacing="8" GridPane.columnSpan="2" GridPane.rowIndex="0" styleClass="callout-card">
                                <Label text="INFO" styleClass="settings-section-title"/>
                                <Label fx:id="infoLabel"
                                       text="Select any ? icon to learn how that option affects feel or readability."
                                       wrapText="true"
                                       styleClass="info-text"/>
                            </VBox>

                            <VBox spacing="12" GridPane.columnIndex="0" GridPane.rowIndex="1" styleClass="settings-section">
                                <Label text="GAMEPLAY TIMERS" styleClass="settings-section-title"/>
                                <VBox spacing="10">
                                    <HBox alignment="CENTER_LEFT" spacing="8" styleClass="form-pair">
                                        <Label text="DAS (ms)" styleClass="form-label">
                                            <tooltip><Tooltip text="Delay before a held move key begins repeating."/></tooltip>
                                        </Label>
                                        <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-das" styleClass="btn-info"/>
                                    </HBox>
                                    <TextField fx:id="dasField"/>

                                    <HBox alignment="CENTER_LEFT" spacing="8" styleClass="form-pair">
                                        <Label text="ARR (ms)" styleClass="form-label">
                                            <tooltip><Tooltip text="Interval between repeats after DAS expires."/></tooltip>
                                        </Label>
                                        <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-arr" styleClass="btn-info"/>
                                    </HBox>
                                    <TextField fx:id="arrField"/>

                                    <HBox alignment="CENTER_LEFT" spacing="8" styleClass="form-pair">
                                        <Label text="Soft Drop Multiplier" styleClass="form-label">
                                            <tooltip><Tooltip text="Scales fall speed while holding the soft drop key."/></tooltip>
                                        </Label>
                                        <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-sdf" styleClass="btn-info"/>
                                    </HBox>
                                    <TextField fx:id="sdfField"/>
                                </VBox>
                            </VBox>

                            <VBox spacing="12" GridPane.columnIndex="0" GridPane.rowIndex="2" styleClass="settings-section">
                                <Label text="AUDIO" styleClass="settings-section-title"/>
                                <CheckBox fx:id="bgmCheckBox" text="Enable background music (menu &amp; gameplay)"/>
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <Label text="BGM Volume" styleClass="form-label"/>
                                    <Slider fx:id="bgmVolumeSlider" min="0" max="100" prefWidth="200"/>
                                </HBox>
                            </VBox>

                            <VBox spacing="12" GridPane.columnIndex="0" GridPane.rowIndex="3" styleClass="settings-section">
                                <Label text="ACCESSIBILITY" styleClass="settings-section-title"/>
                                <HBox alignment="CENTER_LEFT" spacing="8" styleClass="form-pair">
                                    <Label text="Color Assist Mode" styleClass="form-label">
                                        <tooltip><Tooltip text="Swap to bold palettes tailored for common color vision deficiencies."/></tooltip>
                                    </Label>
                                    <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-color-assist" styleClass="btn-info"/>
                                </HBox>
                                <ComboBox fx:id="colorAssistCombo" prefWidth="220"/>

                                <HBox alignment="CENTER_LEFT" spacing="8" styleClass="form-pair">
                                    <Label text="Piece Outlines" styleClass="form-label">
                                        <tooltip><Tooltip text="Adds dark borders so stacked pieces remain readable."/></tooltip>
                                    </Label>
                                    <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-outline" styleClass="btn-info"/>
                                </HBox>
                                <CheckBox fx:id="outlineCheckBox" text="Enable outlines on active, ghost, and preview pieces"/>
                            </VBox>

                            <VBox spacing="12" GridPane.columnIndex="1" GridPane.rowIndex="1" GridPane.rowSpan="3" styleClass="settings-section">
                                <Label text="KEY BINDINGS" styleClass="settings-section-title"/>

                                <VBox spacing="10">
                                    <HBox styleClass="keybind-row">
                                        <HBox alignment="CENTER_LEFT" spacing="6" HBox.hgrow="ALWAYS">
                                            <Label text="Move Left" styleClass="form-label">
                                                <tooltip><Tooltip text="Shift the piece one column to the left."/></tooltip>
                                            </Label>
                                            <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-move-left" styleClass="btn-info"/>
                                        </HBox>
                                        <TextField fx:id="leftKeyField" styleClass="key-badge" editable="false"/>
                                    </HBox>

                                    <HBox styleClass="keybind-row">
                                        <HBox alignment="CENTER_LEFT" spacing="6" HBox.hgrow="ALWAYS">
                                            <Label text="Move Right" styleClass="form-label">
                                                <tooltip><Tooltip text="Shift the piece one column to the right."/></tooltip>
                                            </Label>
                                            <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-move-right" styleClass="btn-info"/>
                                        </HBox>
                                        <TextField fx:id="rightKeyField" styleClass="key-badge" editable="false"/>
                                    </HBox>

                                    <HBox styleClass="keybind-row">
                                        <HBox alignment="CENTER_LEFT" spacing="6" HBox.hgrow="ALWAYS">
                                            <Label text="Soft Drop" styleClass="form-label">
                                                <tooltip><Tooltip text="Speed up descent while held without forcing lock."/></tooltip>
                                            </Label>
                                            <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-soft-drop" styleClass="btn-info"/>
                                        </HBox>
                                        <TextField fx:id="downKeyField" styleClass="key-badge" editable="false"/>
                                    </HBox>

                                    <HBox styleClass="keybind-row">
                                        <HBox alignment="CENTER_LEFT" spacing="6" HBox.hgrow="ALWAYS">
                                            <Label text="Hard Drop" styleClass="form-label">
                                                <tooltip><Tooltip text="Instantly drop to ghost position and lock."/></tooltip>
                                            </Label>
                                            <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-hard-drop" styleClass="btn-info"/>
                                        </HBox>
                                        <TextField fx:id="hardDropKeyField" styleClass="key-badge" editable="false"/>
                                    </HBox>

                                    <HBox styleClass="keybind-row">
                                        <HBox alignment="CENTER_LEFT" spacing="6" HBox.hgrow="ALWAYS">
                                            <Label text="Rotate CW" styleClass="form-label">
                                                <tooltip><Tooltip text="Rotate 90° clockwise."/></tooltip>
                                            </Label>
                                            <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-rotate-cw" styleClass="btn-info"/>
                                        </HBox>
                                        <TextField fx:id="rotateCwField" styleClass="key-badge" editable="false"/>
                                    </HBox>

                                    <HBox styleClass="keybind-row">
                                        <HBox alignment="CENTER_LEFT" spacing="6" HBox.hgrow="ALWAYS">
                                            <Label text="Rotate CCW" styleClass="form-label">
                                                <tooltip><Tooltip text="Rotate 90° counter-clockwise."/></tooltip>
                                            </Label>
                                            <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-rotate-ccw" styleClass="btn-info"/>
                                        </HBox>
                                        <TextField fx:id="rotateCcwField" styleClass="key-badge" editable="false"/>
                                    </HBox>

                                    <HBox styleClass="keybind-row">
                                        <HBox alignment="CENTER_LEFT" spacing="6" HBox.hgrow="ALWAYS">
                                            <Label text="New Game" styleClass="form-label">
                                                <tooltip><Tooltip text="Reset the field instantly and begin a new run."/></tooltip>
                                            </Label>
                                            <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-new-game" styleClass="btn-info"/>
                                        </HBox>
                                        <TextField fx:id="newGameKeyField" styleClass="key-badge" editable="false"/>
                                    </HBox>
                                </VBox>
                            </VBox>

                            <Label fx:id="statusLabel"
                                   GridPane.columnSpan="2"
                                   GridPane.rowIndex="4"
                                   styleClass="status-label"/>
                        </GridPane>
                    </content>
                </ScrollPane>
            </center>
            <bottom>
                <HBox spacing="10" alignment="CENTER_RIGHT" styleClass="settings-footer">
                    <Button text="Reset Defaults" onAction="#onResetDefaults" styleClass="btn-secondary"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Button text="Cancel" onAction="#onCancel" styleClass="btn-ghost"/>
                    <Button text="Save Changes" onAction="#onSave" styleClass="btn-primary"/>
                </HBox>
            </bottom>
            <padding>
                <Insets top="28" right="28" bottom="24" left="28"/>
            </padding>
        </BorderPane>
    </children>
    <stylesheets>
        <URL value="@window_style.css"/>
    </stylesheets>
</StackPane>
