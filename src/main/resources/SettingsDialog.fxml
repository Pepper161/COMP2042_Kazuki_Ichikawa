<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Slider?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.Tooltip?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>
<?import java.net.URL?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.comp2042.app.SettingsController"
            prefWidth="620"
            styleClass="settings-dialog">
    <stylesheets>
        <URL value="@window_style.css"/>
    </stylesheets>
    <top>
        <Label text="SETTINGS" styleClass="settings-header" BorderPane.alignment="CENTER"/>
    </top>
    <center>
        <ScrollPane fitToWidth="true" styleClass="settings-scroll-pane" hbarPolicy="NEVER">
            <content>
                <GridPane hgap="24" styleClass="settings-content">
                    <columnConstraints>
                        <ColumnConstraints percentWidth="50"/>
                        <ColumnConstraints percentWidth="50"/>
                    </columnConstraints>

                    <VBox spacing="18" GridPane.columnIndex="0">
                        <VBox spacing="12" styleClass="settings-section">
                            <Label text="GAMEPLAY" styleClass="settings-section-title"/>
                            <VBox spacing="10">
                                <HBox alignment="CENTER_LEFT" spacing="8">
                                    <Label text="DAS (ms)" styleClass="form-label">
                                        <tooltip>
                                            <Tooltip text="Delayed Auto Shift: wait time before a held move key begins repeating."/>
                                        </tooltip>
                                    </Label>
                                    <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-das" styleClass="btn-info"/>
                                </HBox>
                                <TextField fx:id="dasField"/>

                                <HBox alignment="CENTER_LEFT" spacing="8">
                                    <Label text="ARR (ms)" styleClass="form-label">
                                        <tooltip>
                                            <Tooltip text="Auto Repeat Rate: interval between repeated moves after DAS expires."/>
                                        </tooltip>
                                    </Label>
                                    <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-arr" styleClass="btn-info"/>
                                </HBox>
                                <TextField fx:id="arrField"/>

                                <HBox alignment="CENTER_LEFT" spacing="8">
                                    <Label text="Soft Drop Multiplier" styleClass="form-label">
                                        <tooltip>
                                            <Tooltip text="Boost to manual drop speed when holding the soft-drop key."/>
                                        </tooltip>
                                    </Label>
                                    <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-sdf" styleClass="btn-info"/>
                                </HBox>
                                <TextField fx:id="sdfField"/>
                            </VBox>
                        </VBox>

                        <VBox spacing="12" styleClass="settings-section">
                            <Label text="AUDIO" styleClass="settings-section-title"/>
                            <CheckBox fx:id="bgmCheckBox" text="Enable background music (menu &amp; gameplay)"/>
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="BGM Volume" styleClass="form-label"/>
                                <Slider fx:id="bgmVolumeSlider" min="0" max="100" prefWidth="180"/>
                            </HBox>
                        </VBox>

                        <VBox spacing="12" styleClass="settings-section">
                            <Label text="ACCESSIBILITY" styleClass="settings-section-title"/>
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <Label text="Color Assist Mode" styleClass="form-label">
                                    <tooltip>
                                        <Tooltip text="Choose between the original palette or the high-contrast, colorblind-friendly set."/>
                                    </tooltip>
                                </Label>
                                <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-color-assist" styleClass="btn-info"/>
                            </HBox>
                            <ComboBox fx:id="colorAssistCombo"/>

                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <Label text="Piece Outlines" styleClass="form-label">
                                    <tooltip>
                                        <Tooltip text="Enable to draw a dark border around tiles and Next previews for extra clarity."/>
                                    </tooltip>
                                </Label>
                                <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-outline" styleClass="btn-info"/>
                            </HBox>
                            <CheckBox fx:id="outlineCheckBox"
                                      text="Draw outlines for active, locked, and preview pieces"/>

                            <Label fx:id="infoLabel" wrapText="true" styleClass="info-text"/>
                        </VBox>
                    </VBox>

                    <VBox spacing="12" GridPane.columnIndex="1" styleClass="settings-section">
                        <Label text="CONTROLS" styleClass="settings-section-title"/>
                        <VBox spacing="5">
                            <!-- Move Left -->
                            <HBox styleClass="keybind-row">
                                <HBox alignment="CENTER_LEFT" spacing="6" HBox.hgrow="ALWAYS">
                                    <Label text="Move Left" styleClass="form-label">
                                        <tooltip><Tooltip text="Moves the active piece one column to the left."/></tooltip>
                                    </Label>
                                    <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-move-left" styleClass="btn-info"/>
                                </HBox>
                                <TextField fx:id="leftKeyField" styleClass="key-badge" editable="false"/>
                            </HBox>

                            <!-- Move Right -->
                            <HBox styleClass="keybind-row">
                                <HBox alignment="CENTER_LEFT" spacing="6" HBox.hgrow="ALWAYS">
                                    <Label text="Move Right" styleClass="form-label">
                                        <tooltip><Tooltip text="Moves the active piece one column to the right."/></tooltip>
                                    </Label>
                                    <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-move-right" styleClass="btn-info"/>
                                </HBox>
                                <TextField fx:id="rightKeyField" styleClass="key-badge" editable="false"/>
                            </HBox>

                            <!-- Soft Drop -->
                            <HBox styleClass="keybind-row">
                                <HBox alignment="CENTER_LEFT" spacing="6" HBox.hgrow="ALWAYS">
                                    <Label text="Soft Drop" styleClass="form-label">
                                        <tooltip><Tooltip text="Increases fall speed while held without forcing a lock."/></tooltip>
                                    </Label>
                                    <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-soft-drop" styleClass="btn-info"/>
                                </HBox>
                                <TextField fx:id="downKeyField" styleClass="key-badge" editable="false"/>
                            </HBox>

                            <!-- Hard Drop -->
                            <HBox styleClass="keybind-row">
                                <HBox alignment="CENTER_LEFT" spacing="6" HBox.hgrow="ALWAYS">
                                    <Label text="Hard Drop" styleClass="form-label">
                                        <tooltip><Tooltip text="Instantly drops the piece to the ghost position."/></tooltip>
                                    </Label>
                                    <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-hard-drop" styleClass="btn-info"/>
                                </HBox>
                                <TextField fx:id="hardDropKeyField" styleClass="key-badge" editable="false"/>
                            </HBox>

                            <!-- Rotate CW -->
                            <HBox styleClass="keybind-row">
                                <HBox alignment="CENTER_LEFT" spacing="6" HBox.hgrow="ALWAYS">
                                    <Label text="Rotate CW" styleClass="form-label">
                                        <tooltip><Tooltip text="Rotates the piece clockwise (right rotation)."/>
                                    </tooltip>
                                    </Label>
                                    <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-rotate-cw" styleClass="btn-info"/>
                                </HBox>
                                <TextField fx:id="rotateCwField" styleClass="key-badge" editable="false"/>
                            </HBox>

                            <!-- Rotate CCW -->
                            <HBox styleClass="keybind-row">
                                <HBox alignment="CENTER_LEFT" spacing="6" HBox.hgrow="ALWAYS">
                                    <Label text="Rotate CCW" styleClass="form-label">
                                        <tooltip><Tooltip text="Rotates the piece counter-clockwise (left rotation)."/>
                                    </tooltip>
                                    </Label>
                                    <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-rotate-ccw" styleClass="btn-info"/>
                                </HBox>
                                <TextField fx:id="rotateCcwField" styleClass="key-badge" editable="false"/>
                            </HBox>

                            <!-- New Game -->
                            <HBox styleClass="keybind-row">
                                <HBox alignment="CENTER_LEFT" spacing="6" HBox.hgrow="ALWAYS">
                                    <Label text="New Game" styleClass="form-label">
                                        <tooltip><Tooltip text="Resets the current run instantly when pressed."/></tooltip>
                                    </Label>
                                    <Button text="?" focusTraversable="false" onAction="#showInfo" id="info-new-game" styleClass="btn-info"/>
                                </HBox>
                                <TextField fx:id="newGameKeyField" styleClass="key-badge" editable="false"/>
                            </HBox>
                        </VBox>

                        <Label fx:id="statusLabel" styleClass="status-label"/>
                    </VBox>
                </GridPane>
            </content>
        </ScrollPane>
    </center>
    <bottom>
        <HBox spacing="10" alignment="CENTER_RIGHT" styleClass="settings-footer">
            <Button text="Reset Defaults" onAction="#onResetDefaults" styleClass="btn-secondary"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Button text="Cancel" onAction="#onCancel" styleClass="btn-secondary"/>
            <Button text="Save Changes" onAction="#onSave" styleClass="btn-primary"/>
        </HBox>
    </bottom>
</BorderPane>
